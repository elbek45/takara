# üöÄ Takara DeFi - –ü—Ä–æ—Å—Ç–æ–π –î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Docker Compose

**–≠—Ç–æ –°–ê–ú–´–ô –ü–†–û–°–¢–û–ô —Å–ø–æ—Å–æ–± —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å Takara DeFi!**

–í—Å–µ–≥–æ **5 –∫–æ–º–∞–Ω–¥** - –∏ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç! 

---

## üìã –ß—Ç–æ –≤–∞–º –Ω—É–∂–Ω–æ:

1. **VPS —Å–µ—Ä–≤–µ—Ä** (DigitalOcean Droplet, –ª—é–±–æ–π –¥—Ä—É–≥–æ–π)
   - –ú–∏–Ω–∏–º—É–º: 2 GB RAM, 1 CPU
   - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: 4 GB RAM, 2 CPU ($12/–º–µ—Å—è—Ü)
   - Ubuntu 22.04 LTS

2. **–î–æ—Å—Ç—É–ø –ø–æ SSH**

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (5 –∫–æ–º–∞–Ω–¥)

–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ SSH –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/elbek45/takara.git
cd takara

# 2. –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª
cp .env.example .env

# 3. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env (–í–ê–ñ–ù–û!)
nano .env
# –ò–∑–º–µ–Ω–∏—Ç–µ:
# - DB_PASSWORD (–ª—é–±–æ–π —Å–ª–æ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å)
# - JWT_SECRET (64 —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–∏–º–≤–æ–ª–∞)
# - ADMIN_PASSWORD (–≤–∞—à –∞–¥–º–∏–Ω –ø–∞—Ä–æ–ª—å)
# - VITE_API_URL=http://–í–ê–®_IP_–ê–î–†–ï–°/api
# –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ: Ctrl+O, Enter, Ctrl+X

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–µ–ø–ª–æ–π!
./deploy.sh

# 5. –ì–æ—Ç–æ–≤–æ! üéâ
```

**–í—Å—ë!** –ß–µ—Ä–µ–∑ 5-10 –º–∏–Ω—É—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å!

---

## üîó –î–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:

- **Frontend**: `http://–í–ê–®_IP_–ê–î–†–ï–°`
- **API**: `http://–í–ê–®_IP_–ê–î–†–ï–°/api`
- **Admin Panel**: `http://–í–ê–®_IP_–ê–î–†–ï–°:3001`

---

## üîê –ì–µ–Ω–µ—Ä–∞—Ü–∏—è JWT —Å–µ–∫—Ä–µ—Ç–∞

–ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ JWT_SECRET:

```bash
# –ù–∞ –≤–∞—à–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:
node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"

# –ò–ª–∏ –æ–Ω–ª–∞–π–Ω: https://generate-secret.now.sh/64
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ `.env` —Ñ–∞–π–ª.

---

## üì¶ –ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ?

Docker Compose –∑–∞–ø—É—Å–∫–∞–µ—Ç:

‚úÖ **PostgreSQL 16** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚úÖ **Backend API** (Node.js + Express + Prisma)
‚úÖ **Frontend** (React + Vite + Nginx)
‚úÖ **Admin Panel** (React admin –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)

–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ!

---

## üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å

| –í–∞—Ä–∏–∞–Ω—Ç | –¶–µ–Ω–∞ | –î–ª—è —á–µ–≥–æ |
|---------|------|----------|
| Basic Droplet | $6/–º–µ—Å | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |
| **Recommended** | $12/–º–µ—Å | Prod (–¥–æ 1000 users) |
| Pro Droplet | $24/–º–µ—Å | Prod (–¥–æ 10000 users) |

**–î–µ—à–µ–≤–ª–µ —á–µ–º DigitalOcean App Platform ($20/–º–µ—Å)!**

---

## üõ†Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏:
```bash
docker-compose logs -f
docker-compose logs -f backend  # –¢–æ–ª—å–∫–æ backend
```

### –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ:
```bash
docker-compose down
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å:
```bash
docker-compose restart
```

### –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥:
```bash
git pull
./deploy.sh
```

### –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
```bash
docker exec takara-postgres pg_dump -U takara_user takara_production > backup.sql
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:
```bash
docker exec -i takara-postgres psql -U takara_user takara_production < backup.sql
```

---

## üî• –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∞–π—Ä–≤–æ–ª–∞ (–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ UFW
apt-get update
apt-get install ufw

# –†–∞–∑—Ä–µ—à–∏—Ç–µ SSH
ufw allow 22/tcp

# –†–∞–∑—Ä–µ—à–∏—Ç–µ HTTP/HTTPS
ufw allow 80/tcp
ufw allow 443/tcp

# –†–∞–∑—Ä–µ—à–∏—Ç–µ Admin Panel
ufw allow 3001/tcp

# –í–∫–ª—é—á–∏—Ç–µ —Ñ–∞–π—Ä–≤–æ–ª
ufw enable
```

---

## üåê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–∞ (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ–º–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, `takara.io`):

1. **–î–æ–±–∞–≤—å—Ç–µ A-–∑–∞–ø–∏—Å—å** –≤ DNS:
   ```
   Type: A
   Name: @
   Value: –í–ê–®_IP_–ê–î–†–ï–°
   ```

2. **–û–±–Ω–æ–≤–∏—Ç–µ .env**:
   ```bash
   VITE_API_URL=http://takara.io/api
   CORS_ORIGIN=http://takara.io
   ```

3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ**:
   ```bash
   docker-compose down
   docker-compose up -d
   ```

---

## üîí –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HTTPS (SSL)

–î–ª—è –∑–∞—â–∏—â–µ–Ω–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è:

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Certbot
apt-get install certbot

# 2. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down

# 3. –ü–æ–ª—É—á–∏—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
certbot certonly --standalone -d takara.io

# 4. –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –±—É–¥—É—Ç –≤:
# /etc/letsencrypt/live/takara.io/

# 5. –û–±–Ω–æ–≤–∏—Ç–µ docker-compose.yml –¥–ª—è SSL (—Å–º. HTTPS_SETUP.md)

# 6. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞
docker-compose up -d
```

---

## üö® –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è:

```bash
# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏
docker-compose logs

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
docker-compose ps

# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑—ã
docker-compose down
docker-compose build --no-cache
docker-compose up -d
```

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ PostgreSQL —Ä–∞–±–æ—Ç–∞–µ—Ç
docker-compose ps postgres

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
docker-compose restart postgres

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–æ–ª—å –≤ .env
```

### Frontend –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ API:

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ VITE_API_URL –≤ .env
# –î–æ–ª–∂–µ–Ω –±—ã—Ç—å: http://–í–ê–®_IP/api

# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ frontend
docker-compose build frontend
docker-compose up -d frontend
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è:

```bash
# CPU –∏ –ø–∞–º—è—Ç—å
docker stats

# –†–∞–∑–º–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
docker exec takara-postgres psql -U takara_user -d takara_production -c "SELECT pg_size_pretty(pg_database_size('takara_production'));"

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
docker exec takara-postgres psql -U takara_user -d takara_production -c "SELECT COUNT(*) FROM \"User\";"
```

---

## üéØ –ß—Ç–æ –¥–∞–ª—å—à–µ?

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è:

1. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏
2. ‚úÖ –ü–æ–¥–∫–ª—é—á–∏—Ç–µ Phantom –∫–æ—à–µ–ª–µ–∫
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É pools
4. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
5. üöÄ **–ì–æ—Ç–æ–≤—ã –∫ –∑–∞–ø—É—Å–∫—É!**

–î–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ mainnet: —Å–º. `MAINNET_MIGRATION_GUIDE.md`

---

## üí° –°–æ–≤–µ—Ç—ã

- –î–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Ä–µ–≥—É–ª—è—Ä–Ω–æ
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- –û–±–Ω–æ–≤–ª—è–π—Ç–µ –∫–æ–¥ —Ä–µ–≥—É–ª—è—Ä–Ω–æ (`git pull && ./deploy.sh`)
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –¥–ª—è production
- –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏: `docker-compose logs -f`

---

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

**–ü—Ä–æ–±–ª–µ–º—ã?** –°–æ–∑–¥–∞–π—Ç–µ issue: https://github.com/elbek45/takara/issues

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**:
- –ü–æ–¥—Ä–æ–±–Ω—ã–π –≥–∞–π–¥: `DIGITALOCEAN_DEPLOYMENT.md`
- Mainnet –º–∏–≥—Ä–∞—Ü–∏—è: `MAINNET_MIGRATION_GUIDE.md`
- Production —á–µ–∫–ª–∏—Å—Ç: `PRODUCTION_DEPLOYMENT_CHECKLIST.md`

---

**–í–µ—Ä—Å–∏—è**: 1.0.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2025-11-13

–£–¥–∞—á–∏! üöÄ
